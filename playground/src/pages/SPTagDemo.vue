<template>
  <DemoContainer title="SPTag æ ‡ç­¾ç»„ä»¶">
    <!-- åŸºç¡€ç”¨æ³• -->
    <DemoSection title="åŸºç¡€ç”¨æ³•" subtitle="æ ‡ç­¾çš„åŸºæœ¬ä½¿ç”¨æ–¹å¼">
      <div class="tag-group">
        <sp-tag>é»˜è®¤æ ‡ç­¾</sp-tag>
        <sp-tag text="æ–‡æœ¬æ ‡ç­¾" />
        <sp-tag>Vue.js</sp-tag>
        <sp-tag>React</sp-tag>
        <sp-tag>Angular</sp-tag>
      </div>
    </DemoSection>

    <sp-space :size="24" />

    <!-- ä¸åŒé¢œè‰² -->
    <DemoSection title="ä¸åŒé¢œè‰²" subtitle="æ”¯æŒå¤šç§é¢œè‰²ä¸»é¢˜">
      <div class="tag-group">
        <sp-tag color="primary">ä¸»è¦</sp-tag>
        <sp-tag color="secondary">æ¬¡è¦</sp-tag>
        <sp-tag color="success">æˆåŠŸ</sp-tag>
        <sp-tag color="warning">è­¦å‘Š</sp-tag>
        <sp-tag color="error">é”™è¯¯</sp-tag>
        <sp-tag color="info">ä¿¡æ¯</sp-tag>
      </div>
    </DemoSection>

    <sp-space :size="24" />

    <!-- ä¸åŒå°ºå¯¸ -->
    <DemoSection title="ä¸åŒå°ºå¯¸" subtitle="æä¾›å¤šç§å°ºå¯¸é€‰æ‹©">
      <div class="tag-group">
        <sp-tag size="x-small">è¶…å°</sp-tag>
        <sp-tag size="small">å°</sp-tag>
        <sp-tag size="default">é»˜è®¤</sp-tag>
        <sp-tag size="large">å¤§</sp-tag>
        <sp-tag size="x-large">è¶…å¤§</sp-tag>
      </div>
    </DemoSection>

    <sp-space :size="24" />

    <!-- ä¸åŒå˜ä½“ -->
    <DemoSection title="ä¸åŒå˜ä½“" subtitle="æ”¯æŒå¤šç§è§†è§‰é£æ ¼">
      <div class="tag-group">
        <sp-tag variant="flat" color="primary">å¹³é¢</sp-tag>
        <sp-tag variant="elevated" color="primary">æµ®èµ·</sp-tag>
        <sp-tag variant="tonal" color="primary">è‰²è°ƒ</sp-tag>
        <sp-tag variant="outlined" color="primary">è½®å»“</sp-tag>
        <sp-tag variant="text" color="primary">æ–‡æœ¬</sp-tag>
        <sp-tag variant="plain" color="primary">æœ´ç´ </sp-tag>
      </div>
    </DemoSection>

    <sp-space :size="24" />

    <!-- å¯å…³é—­æ ‡ç­¾ -->
    <DemoSection title="å¯å…³é—­æ ‡ç­¾" subtitle="æ”¯æŒå…³é—­æ“ä½œçš„æ ‡ç­¾">
      <div class="tag-group">
        <sp-tag
          v-for="(tag, index) in closableTags"
          :key="index"
          :model-value="tag.visible"
          @update:model-value="tag.visible = $event"
          closable
          :color="tag.color"
        >
          {{ tag.text }}
        </sp-tag>
      </div>
      <sp-space :size="16" />
      <sp-btn @click="resetClosableTags">é‡ç½®æ ‡ç­¾</sp-btn>
    </DemoSection>

    <sp-space :size="24" />

    <!-- å¸¦å›¾æ ‡çš„æ ‡ç­¾ -->
    <DemoSection title="å¸¦å›¾æ ‡çš„æ ‡ç­¾" subtitle="æ ‡ç­¾å¯ä»¥æ·»åŠ å‰ç½®æˆ–åç½®å›¾æ ‡">
      <div class="tag-group">
        <sp-tag prepend-icon="mdi-account" color="primary">ç”¨æˆ·</sp-tag>
        <sp-tag append-icon="mdi-close" color="error">åˆ é™¤</sp-tag>
        <sp-tag prepend-icon="mdi-star" append-icon="mdi-heart" color="warning">æ”¶è—</sp-tag>
        <sp-tag prepend-icon="mdi-check" color="success">å®Œæˆ</sp-tag>
      </div>
    </DemoSection>

    <sp-space :size="24" />

    <!-- æ ‡ç­¾å½¢çŠ¶ -->
    <DemoSection title="æ ‡ç­¾å½¢çŠ¶" subtitle="ä¸åŒçš„åœ†è§’å’Œå½¢çŠ¶æ ·å¼">
      <div class="tag-group">
        <sp-tag>é»˜è®¤åœ†è§’</sp-tag>
        <sp-tag label>æ ‡ç­¾å½¢çŠ¶</sp-tag>
        <sp-tag pill>èƒ¶å›Šå½¢çŠ¶</sp-tag>
        <sp-tag rounded="0">æ— åœ†è§’</sp-tag>
        <sp-tag rounded="xl">è¶…å¤§åœ†è§’</sp-tag>
      </div>
    </DemoSection>

    <sp-space :size="24" />

    <!-- å¯†åº¦è°ƒæ•´ -->
    <DemoSection title="å¯†åº¦è°ƒæ•´" subtitle="è°ƒæ•´æ ‡ç­¾çš„å†…è¾¹è·å¤§å°">
      <div class="tag-group">
        <sp-tag density="default">é»˜è®¤å¯†åº¦</sp-tag>
        <sp-tag density="comfortable">èˆ’é€‚å¯†åº¦</sp-tag>
        <sp-tag density="compact">ç´§å‡‘å¯†åº¦</sp-tag>
      </div>
    </DemoSection>

    <sp-space :size="24" />

    <!-- è¿‡æ»¤æ ‡ç­¾ -->
    <DemoSection title="è¿‡æ»¤æ ‡ç­¾" subtitle="å¯ä»¥ç”¨ä½œè¿‡æ»¤å™¨çš„äº¤äº’å¼æ ‡ç­¾">
      <div class="tag-group">
        <sp-tag
          v-for="(filter, index) in filterTags"
          :key="index"
          :model-value="filter.active"
          @update:model-value="filter.active = $event"
          filter
          :color="filter.active ? 'primary' : 'default'"
          @click="filter.active = !filter.active"
        >
          {{ filter.text }}
        </sp-tag>
      </div>
      <sp-space :size="12" />
      <div class="status-display">å·²é€‰æ‹©çš„è¿‡æ»¤å™¨: {{ activeFilters.join(', ') || 'æ— ' }}</div>
    </DemoSection>

    <sp-space :size="24" />

    <!-- é“¾æ¥æ ‡ç­¾ -->
    <DemoSection title="é“¾æ¥æ ‡ç­¾" subtitle="å¯ç‚¹å‡»çš„é“¾æ¥æ ·å¼æ ‡ç­¾">
      <div class="tag-group">
        <sp-tag link @click="handleTagClick('Vue.js')">Vue.js</sp-tag>
        <sp-tag link @click="handleTagClick('React')">React</sp-tag>
        <sp-tag link @click="handleTagClick('Angular')">Angular</sp-tag>
        <sp-tag link disabled>ç¦ç”¨é“¾æ¥</sp-tag>
      </div>
      <sp-space :size="12" />
      <div v-if="clickedTag" class="status-display">ç‚¹å‡»äº†: {{ clickedTag }}</div>
    </DemoSection>

    <sp-space :size="24" />

    <!-- ç¦ç”¨çŠ¶æ€ -->
    <DemoSection title="ç¦ç”¨çŠ¶æ€" subtitle="æ ‡ç­¾çš„ç¦ç”¨çŠ¶æ€å±•ç¤º">
      <div class="tag-group">
        <sp-tag>æ­£å¸¸æ ‡ç­¾</sp-tag>
        <sp-tag disabled>ç¦ç”¨æ ‡ç­¾</sp-tag>
        <sp-tag disabled color="primary">ç¦ç”¨ä¸»è¦</sp-tag>
        <sp-tag disabled closable>ç¦ç”¨å¯å…³é—­</sp-tag>
      </div>
    </DemoSection>

    <sp-space :size="24" />

    <!-- è‡ªå®šä¹‰å†…å®¹ -->
    <DemoSection title="è‡ªå®šä¹‰å†…å®¹" subtitle="ä½¿ç”¨æ’æ§½è‡ªå®šä¹‰æ ‡ç­¾å†…å®¹">
      <div class="tag-group">
        <sp-tag color="primary" closable>
          <template #prepend>
            <span style="margin-right: 4px">ğŸ‘¤</span>
          </template>
          ç”¨æˆ·æ ‡ç­¾
        </sp-tag>
        <sp-tag color="success" closable>
          <template #append>
            <span style="margin-left: 4px">âœ“</span>
          </template>
          å®Œæˆä»»åŠ¡
        </sp-tag>
        <sp-tag color="warning">
          <template #prepend>
            <span style="margin-right: 4px">â­</span>
          </template>
          é‡è¦
          <template #append>
            <span style="margin-left: 4px">!</span>
          </template>
        </sp-tag>
      </div>
    </DemoSection>

    <sp-space :size="24" />

    <!-- åŠ¨æ€æ ‡ç­¾ç®¡ç† -->
    <DemoSection title="åŠ¨æ€æ ‡ç­¾ç®¡ç†" subtitle="åŠ¨æ€æ·»åŠ å’Œåˆ é™¤æ ‡ç­¾">
      <div class="tag-group">
        <sp-tag
          v-for="(tag, index) in dynamicTags"
          :key="index"
          :model-value="true"
          @update:model-value="removeDynamicTag(index)"
          closable
          color="primary"
        >
          {{ tag }}
        </sp-tag>
        <sp-tag v-if="showInput" variant="outlined" style="padding: 0">
          <input
            ref="inputRef"
            v-model="inputValue"
            @blur="handleInputConfirm"
            @keyup.enter="handleInputConfirm"
            class="tag-input"
            placeholder="æ–°æ ‡ç­¾"
          />
        </sp-tag>
        <sp-tag v-else variant="outlined" @click="showInputTag" style="border-style: dashed">
          + æ·»åŠ æ ‡ç­¾
        </sp-tag>
      </div>
    </DemoSection>

    <sp-space :size="24" />

    <!-- SPTagGroup æ ‡ç­¾ç»„ -->
    <DemoSection title="SPTagGroup æ ‡ç­¾ç»„" subtitle="ä½¿ç”¨æ ‡ç­¾ç»„ç®¡ç†å¤šä¸ªæ ‡ç­¾">
      <!-- åŸºç¡€æ ‡ç­¾ç»„ -->
      <div class="subsection">
        <h3>åŸºç¡€æ ‡ç­¾ç»„ï¼ˆå¤šé€‰ï¼‰</h3>
        <sp-tag-group v-model="selectedTags" multiple>
          <sp-tag
            v-for="tag in basicTags"
            :key="tag.value"
            :value="tag.value"
            :color="tag.color"
          >
            {{ tag.text }}
          </sp-tag>
        </sp-tag-group>
        <sp-space :size="12" />
        <div class="status-display">å·²é€‰æ‹©: {{ selectedTags.join(', ') || 'æ— ' }}</div>
      </div>

      <sp-space :size="20" />

      <!-- å•é€‰æ ‡ç­¾ç»„ -->
      <div class="subsection">
        <h3>å•é€‰æ ‡ç­¾ç»„</h3>
        <sp-tag-group v-model="selectedSingleTag">
          <sp-tag
            v-for="tag in singleSelectTags"
            :key="tag.value"
            :value="tag.value"
            :color="tag.color"
          >
            {{ tag.text }}
          </sp-tag>
        </sp-tag-group>
        <sp-space :size="12" />
        <div class="status-display">å·²é€‰æ‹©: {{ selectedSingleTag || 'æ— ' }}</div>
      </div>

      <sp-space :size="20" />

      <!-- å‚ç›´æ ‡ç­¾ç»„ -->
      <div class="subsection">
        <h3>å‚ç›´æ ‡ç­¾ç»„</h3>
        <sp-tag-group v-model="selectedVerticalTags" multiple column>
          <sp-tag
            v-for="tag in verticalTags"
            :key="tag.value"
            :value="tag.value"
            :color="tag.color"
          >
            {{ tag.text }}
          </sp-tag>
        </sp-tag-group>
        <sp-space :size="12" />
        <div class="status-display">å·²é€‰æ‹©: {{ selectedVerticalTags.join(', ') || 'æ— ' }}</div>
      </div>

      <sp-space :size="20" />

      <!-- å¯æ»šåŠ¨æ ‡ç­¾ç»„ -->
      <div class="subsection">
        <h3>å¯æ»šåŠ¨æ ‡ç­¾ç»„</h3>
        <sp-tag-group v-model="selectedScrollTags" multiple show-arrows style="max-width: 400px">
          <sp-tag
            v-for="tag in scrollTags"
            :key="tag.value"
            :value="tag.value"
            :color="tag.color"
          >
            {{ tag.text }}
          </sp-tag>
        </sp-tag-group>
        <sp-space :size="12" />
        <div class="status-display">å·²é€‰æ‹©: {{ selectedScrollTags.join(', ') || 'æ— ' }}</div>
      </div>

      <sp-space :size="20" />

      <!-- è¿‡æ»¤å™¨æ ‡ç­¾ç»„ -->
      <div class="subsection">
        <h3>è¿‡æ»¤å™¨æ ‡ç­¾ç»„</h3>
        <sp-tag-group v-model="selectedFilterTags" multiple filter>
          <sp-tag
            v-for="tag in filterTagsGroup"
            :key="tag.value"
            :value="tag.value"
            :color="tag.color"
          >
            {{ tag.text }}
          </sp-tag>
        </sp-tag-group>
        <sp-space :size="12" />
        <div class="status-display">å·²é€‰æ‹©: {{ selectedFilterTags.join(', ') || 'æ— ' }}</div>
      </div>
    </DemoSection>
  </DemoContainer>
</template>

<script setup lang="ts">
import { ref, computed, nextTick } from 'vue'
import DemoContainer from '../components/DemoContainer.vue'
import DemoSection from '../components/DemoSection.vue'

// å“åº”å¼æ•°æ®
const closableTags = ref([
  { text: 'Vue.js', color: 'success', visible: true },
  { text: 'React', color: 'info', visible: true },
  { text: 'Angular', color: 'error', visible: true },
  { text: 'Svelte', color: 'warning', visible: true },
])

const filterTags = ref([
  { text: 'å‰ç«¯', active: false },
  { text: 'åç«¯', active: false },
  { text: 'ç§»åŠ¨ç«¯', active: false },
  { text: 'å…¨æ ˆ', active: false },
])

const clickedTag = ref('')
const dynamicTags = ref(['æ ‡ç­¾1', 'æ ‡ç­¾2', 'æ ‡ç­¾3'])
const showInput = ref(false)
const inputValue = ref('')
const inputRef = ref()

// SPTagGroup ç›¸å…³æ•°æ®
const selectedTags = ref(['vue', 'typescript'])
const selectedSingleTag = ref('vue')
const selectedVerticalTags = ref(['frontend'])
const selectedScrollTags = ref(['javascript'])
const selectedFilterTags = ref(['web'])

const basicTags = ref([
  { text: 'Vue.js', value: 'vue', color: 'success' },
  { text: 'React', value: 'react', color: 'info' },
  { text: 'Angular', value: 'angular', color: 'error' },
  { text: 'TypeScript', value: 'typescript', color: 'primary' },
  { text: 'JavaScript', value: 'javascript', color: 'warning' },
])

const singleSelectTags = ref([
  { text: 'Vue.js', value: 'vue', color: 'success' },
  { text: 'React', value: 'react', color: 'info' },
  { text: 'Angular', value: 'angular', color: 'error' },
  { text: 'Svelte', value: 'svelte', color: 'secondary' },
])

const verticalTags = ref([
  { text: 'å‰ç«¯å¼€å‘', value: 'frontend', color: 'primary' },
  { text: 'åç«¯å¼€å‘', value: 'backend', color: 'secondary' },
  { text: 'ç§»åŠ¨å¼€å‘', value: 'mobile', color: 'success' },
  { text: 'å…¨æ ˆå¼€å‘', value: 'fullstack', color: 'warning' },
  { text: 'DevOps', value: 'devops', color: 'error' },
])

const scrollTags = ref([
  { text: 'JavaScript', value: 'javascript', color: 'warning' },
  { text: 'TypeScript', value: 'typescript', color: 'primary' },
  { text: 'Vue.js', value: 'vue', color: 'success' },
  { text: 'React', value: 'react', color: 'info' },
  { text: 'Angular', value: 'angular', color: 'error' },
  { text: 'Node.js', value: 'nodejs', color: 'success' },
  { text: 'Express', value: 'express', color: 'secondary' },
  { text: 'MongoDB', value: 'mongodb', color: 'success' },
  { text: 'MySQL', value: 'mysql', color: 'info' },
  { text: 'Redis', value: 'redis', color: 'error' },
])

const filterTagsGroup = ref([
  { text: 'Webå¼€å‘', value: 'web', color: 'primary' },
  { text: 'ç§»åŠ¨å¼€å‘', value: 'mobile', color: 'success' },
  { text: 'æ¡Œé¢åº”ç”¨', value: 'desktop', color: 'info' },
  { text: 'æ¸¸æˆå¼€å‘', value: 'game', color: 'warning' },
  { text: 'äººå·¥æ™ºèƒ½', value: 'ai', color: 'error' },
])

// è®¡ç®—å±æ€§
const activeFilters = computed(() => {
  return filterTags.value.filter(f => f.active).map(f => f.text)
})

// æ–¹æ³•
const resetClosableTags = () => {
  closableTags.value.forEach(tag => {
    tag.visible = true
  })
}

const handleTagClick = (tagName: string) => {
  clickedTag.value = tagName
  setTimeout(() => {
    clickedTag.value = ''
  }, 2000)
}

const removeDynamicTag = (index: number) => {
  dynamicTags.value.splice(index, 1)
}

const showInputTag = () => {
  showInput.value = true
  nextTick(() => {
    inputRef.value?.focus()
  })
}

const handleInputConfirm = () => {
  if (inputValue.value.trim()) {
    dynamicTags.value.push(inputValue.value.trim())
  }
  inputValue.value = ''
  showInput.value = false
}
</script>

<style scoped>
.tag-group {
  display: flex;
  flex-wrap: wrap;
  gap: 12px;
  align-items: center;
}

.status-display {
  padding: 12px;
  background-color: #f5f5f5;
  border-radius: 8px;
  color: #333;
  font-size: 14px;
}

.subsection {
  padding: 16px;
  background-color: #fafafa;
  border-radius: 8px;
  border: 1px solid #e0e0e0;
}

.subsection h3 {
  margin: 0 0 12px 0;
  font-size: 16px;
  font-weight: 600;
  color: #333;
}

.tag-input {
  border: none;
  outline: none;
  background: transparent;
  padding: 4px 8px;
  width: 80px;
  font-family: inherit;
  font-size: inherit;
}
</style>
